{"ast":null,"code":"import _regeneratorRuntime from\"E:/chatapp/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"E:/chatapp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"E:/chatapp/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{ChatState}from'../../Context/ChatProvider';import{Box,Button,Flex,Stack,Text,useToast}from'@chakra-ui/react';import{AddIcon}from'@chakra-ui/icons';import axios from'axios';import ChatLoading from'../ChatLoading';import{getSender}from'../../config/ChatLogics';import GroupChatModal from'./GroupChatModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MyChats=function MyChats(_ref){var fetchAgain=_ref.fetchAgain,setFetchAgain=_ref.setFetchAgain,openChatBox=_ref.openChatBox;// Pass openChatBox callback\nvar _ChatState=ChatState(),user=_ChatState.user,setChats=_ChatState.setChats,selectedChat=_ChatState.selectedChat,setSelectedChat=_ChatState.setSelectedChat,chats=_ChatState.chats;var _useState=useState(),_useState2=_slicedToArray(_useState,2),loggedUser=_useState2[0],setLoggedUser=_useState2[1];var toast=useToast();var fetchChats=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var config,_yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;config={headers:{Authorization:\"Bearer \".concat(user.token)}};_context.next=4;return axios.get('/api/chat',config);case 4:_yield$axios$get=_context.sent;data=_yield$axios$get.data;console.log(data);setChats(data);_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);toast({title:'Error Occurred',description:'Failed to load chat',status:'error',duration:3000,isClosable:true,position:'bottom-left'});case 13:case\"end\":return _context.stop();}},_callee,null,[[0,10]]);}));return function fetchChats(){return _ref2.apply(this,arguments);};}();useEffect(function(){setLoggedUser(JSON.parse(localStorage.getItem(\"userInfo\")));fetchChats();},[fetchAgain]);var chat=selectedChat!==null;var handleUserClick=function handleUserClick(){openChatBox();// Open the ChatBox when a user is clicked\n};return/*#__PURE__*/_jsxs(Box,{p:3,bg:\"white\",borderRadius:\"lg\",borderWidth:\"1px\",boxShadow:\"md\",justifyContent:\"space-between\",children:[/*#__PURE__*/_jsxs(Flex,{fontSize:{base:'24px',md:'30px'},fontFamily:\"Work Sans\",borderBottom:\"1px solid gray\",alignItems:\"center\",children:[\"My Chats\",/*#__PURE__*/_jsx(GroupChatModal,{children:/*#__PURE__*/_jsx(Button,{fontSize:{base:'16px',md:'20px',lg:'24px'},rightIcon:/*#__PURE__*/_jsx(AddIcon,{}),justifyContent:\"flex-end\",children:\"New Group Chat\"})})]}),/*#__PURE__*/_jsx(Flex,{flexDirection:\"column\",p:3,bg:\"#F8F8F8\",borderRadius:\"lg\",overflow:\"hidden\",children:chats?/*#__PURE__*/_jsx(Stack,{spacing:2,overflowY:\"scroll\",children:chats.map(function(chat){return/*#__PURE__*/_jsx(Box,{onClick:function onClick(){setSelectedChat(chat);handleUserClick();// Handle user click to open ChatBox\n},cursor:\"pointer\",bg:selectedChat===chat?'#38B2AC':'#E8E8E8',color:selectedChat===chat?'white':'black',p:2,borderRadius:\"lg\",children:/*#__PURE__*/_jsx(Text,{children:!chat.isGroupChat?getSender(loggedUser,chat.users):chat.chatName})},chat._id);})}):/*#__PURE__*/_jsx(ChatLoading,{})})]});};export default MyChats;","map":{"version":3,"names":["React","useEffect","useState","ChatState","Box","Button","Flex","Stack","Text","useToast","AddIcon","axios","ChatLoading","getSender","GroupChatModal","jsx","_jsx","jsxs","_jsxs","MyChats","_ref","fetchAgain","setFetchAgain","openChatBox","_ChatState","user","setChats","selectedChat","setSelectedChat","chats","_useState","_useState2","_slicedToArray","loggedUser","setLoggedUser","toast","fetchChats","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","config","_yield$axios$get","data","wrap","_callee$","_context","prev","next","headers","Authorization","concat","token","get","sent","console","log","t0","title","description","status","duration","isClosable","position","stop","apply","arguments","JSON","parse","localStorage","getItem","chat","handleUserClick","p","bg","borderRadius","borderWidth","boxShadow","justifyContent","children","fontSize","base","md","fontFamily","borderBottom","alignItems","lg","rightIcon","flexDirection","overflow","spacing","overflowY","map","onClick","cursor","color","isGroupChat","users","chatName","_id"],"sources":["E:/chatapp/client/src/components/miscellaneous/MyChats.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { ChatState } from '../../Context/ChatProvider';\r\nimport { Box, Button, Flex, Stack, Text, useToast } from '@chakra-ui/react';\r\nimport { AddIcon } from '@chakra-ui/icons';\r\nimport axios from 'axios';\r\nimport ChatLoading from '../ChatLoading';\r\nimport { getSender } from '../../config/ChatLogics';\r\nimport GroupChatModal from './GroupChatModal';\r\n\r\nconst MyChats = ({ fetchAgain, setFetchAgain, openChatBox }) => { // Pass openChatBox callback\r\n  const { user, setChats, selectedChat, setSelectedChat, chats } = ChatState();\r\n  const [loggedUser, setLoggedUser] = useState();\r\n  const toast = useToast();\r\n\r\n  const fetchChats = async () => {\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      const { data } = await axios.get('/api/chat', config);\r\n      console.log(data);\r\n      setChats(data);\r\n    } catch (error) {\r\n      toast({\r\n        title: 'Error Occurred',\r\n        description: 'Failed to load chat',\r\n        status: 'error',\r\n        duration: 3000,\r\n        isClosable: true,\r\n        position: 'bottom-left',\r\n      });\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    setLoggedUser(JSON.parse(localStorage.getItem(\"userInfo\")))\r\n    fetchChats();\r\n  }, [fetchAgain]);\r\n\r\n  const chat = selectedChat !== null;\r\n\r\n  const handleUserClick = () => {\r\n    openChatBox(); // Open the ChatBox when a user is clicked\r\n  };\r\n\r\n  return (\r\n    <Box\r\n      p={3}\r\n      bg=\"white\"\r\n      borderRadius=\"lg\"\r\n      borderWidth=\"1px\"\r\n      boxShadow=\"md\"\r\n      justifyContent=\"space-between\"\r\n    >\r\n      <Flex\r\n        fontSize={{ base: '24px', md: '30px' }}\r\n        fontFamily=\"Work Sans\"\r\n        borderBottom=\"1px solid gray\"\r\n        alignItems=\"center\"\r\n      >\r\n        My Chats\r\n\r\n        <GroupChatModal>\r\n          <Button\r\n            fontSize={{ base: '16px', md: '20px', lg: '24px' }}\r\n            rightIcon={<AddIcon />}\r\n            justifyContent=\"flex-end\"\r\n          >\r\n            New Group Chat\r\n          </Button>\r\n        </GroupChatModal>\r\n      </Flex>\r\n\r\n      <Flex\r\n        flexDirection=\"column\"\r\n        p={3}\r\n        bg=\"#F8F8F8\"\r\n        borderRadius=\"lg\"\r\n        overflow=\"hidden\"\r\n      >\r\n        {chats ? (\r\n          <Stack spacing={2} overflowY=\"scroll\">\r\n            {chats.map((chat) => (\r\n              <Box\r\n                onClick={() => {\r\n                  setSelectedChat(chat);\r\n                  handleUserClick(); // Handle user click to open ChatBox\r\n                }}\r\n                cursor=\"pointer\"\r\n                bg={selectedChat === chat ? '#38B2AC' : '#E8E8E8'}\r\n                color={selectedChat === chat ? 'white' : 'black'}\r\n                p={2}\r\n                borderRadius=\"lg\"\r\n                key={chat._id}\r\n              >\r\n                <Text>\r\n                  {!chat.isGroupChat\r\n                    ? getSender(loggedUser, chat.users)\r\n                    : chat.chatName}\r\n                </Text>\r\n              </Box>\r\n            ))}\r\n          </Stack>\r\n        ) : (\r\n          <ChatLoading />\r\n        )}\r\n      </Flex>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default MyChats;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}